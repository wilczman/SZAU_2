%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.530974e+003; foe(n+1)=2.423394e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.691523e+003; foe(n+1)=1.866611e+003; krok(n+1)=4.651747e-004; ng(n+1)=5.728891e+003;
n=2; farx(n+1)=9.980260e+002; foe(n+1)=3.008279e+003; krok(n+1)=5.972073e-004; ng(n+1)=4.043420e+003;
n=3; farx(n+1)=7.526637e+002; foe(n+1)=6.458890e+003; krok(n+1)=2.219001e-004; ng(n+1)=4.991100e+003;
n=4; farx(n+1)=9.088157e+001; foe(n+1)=1.474530e+003; krok(n+1)=3.907882e-003; ng(n+1)=5.029543e+003;
n=5; farx(n+1)=7.661195e+001; foe(n+1)=7.765625e+002; krok(n+1)=1.954649e-004; ng(n+1)=2.293251e+003;
n=6; farx(n+1)=2.297831e+001; foe(n+1)=2.331796e+003; krok(n+1)=3.778589e-003; ng(n+1)=1.247321e+003;
n=7; farx(n+1)=1.356709e+001; foe(n+1)=6.253931e+002; krok(n+1)=3.334617e-003; ng(n+1)=2.776419e+002;
n=8; farx(n+1)=1.046914e+001; foe(n+1)=3.007231e+002; krok(n+1)=1.612540e-003; ng(n+1)=4.597688e+002;
n=9; farx(n+1)=9.622931e+000; foe(n+1)=2.367263e+002; krok(n+1)=5.631405e-003; ng(n+1)=2.437894e+002;
n=10; farx(n+1)=6.507341e+000; foe(n+1)=2.568369e+002; krok(n+1)=5.699196e-003; ng(n+1)=1.867004e+002;
n=11; farx(n+1)=5.260223e+000; foe(n+1)=1.970338e+002; krok(n+1)=2.508493e-002; ng(n+1)=4.103074e+002;
n=12; farx(n+1)=4.604277e+000; foe(n+1)=2.044727e+002; krok(n+1)=2.429096e-002; ng(n+1)=2.307158e+002;
n=13; farx(n+1)=4.084292e+000; foe(n+1)=2.538094e+002; krok(n+1)=8.631803e-003; ng(n+1)=3.324930e+002;
n=14; farx(n+1)=3.855894e+000; foe(n+1)=2.615341e+002; krok(n+1)=2.667694e-002; ng(n+1)=1.318078e+002;
n=15; farx(n+1)=3.458631e+000; foe(n+1)=2.338091e+002; krok(n+1)=3.094863e-002; ng(n+1)=2.139264e+002;
n=16; farx(n+1)=3.074569e+000; foe(n+1)=1.623078e+002; krok(n+1)=3.262119e-002; ng(n+1)=2.319462e+002;
n=17; farx(n+1)=2.695217e+000; foe(n+1)=1.549884e+002; krok(n+1)=7.224169e-002; ng(n+1)=9.262347e+001;
n=18; farx(n+1)=2.375702e+000; foe(n+1)=1.296782e+002; krok(n+1)=3.252259e-002; ng(n+1)=2.286306e+002;
n=19; farx(n+1)=1.897499e+000; foe(n+1)=1.324572e+002; krok(n+1)=9.809225e-002; ng(n+1)=1.722335e+002;
n=20; farx(n+1)=1.421355e+000; foe(n+1)=9.618290e+001; krok(n+1)=1.039503e-001; ng(n+1)=1.360027e+002;
n=21; farx(n+1)=1.140480e+000; foe(n+1)=5.466677e+001; krok(n+1)=2.447549e-002; ng(n+1)=1.653329e+002;
n=22; farx(n+1)=4.966915e-001; foe(n+1)=5.450892e+001; krok(n+1)=1.101515e-001; ng(n+1)=9.992188e+001;
n=23; farx(n+1)=3.942898e-001; foe(n+1)=4.145376e+001; krok(n+1)=1.142218e-002; ng(n+1)=7.325009e+001;
n=24; farx(n+1)=3.288291e-001; foe(n+1)=2.888963e+001; krok(n+1)=3.149998e-002; ng(n+1)=3.302195e+001;
n=25; farx(n+1)=2.337579e-001; foe(n+1)=2.178688e+001; krok(n+1)=6.918375e-002; ng(n+1)=2.671130e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.074916e-001; foe(n+1)=1.605809e+001; krok(n+1)=7.271253e-005; ng(n+1)=9.729617e+001;
n=27; farx(n+1)=2.006121e-001; foe(n+1)=1.654116e+001; krok(n+1)=1.830478e-003; ng(n+1)=1.020068e+001;
n=28; farx(n+1)=1.905665e-001; foe(n+1)=1.498445e+001; krok(n+1)=4.395065e-004; ng(n+1)=2.381456e+001;
n=29; farx(n+1)=1.868218e-001; foe(n+1)=1.537286e+001; krok(n+1)=3.223493e-003; ng(n+1)=5.847510e+000;
n=30; farx(n+1)=1.556638e-001; foe(n+1)=1.253246e+001; krok(n+1)=4.134280e-002; ng(n+1)=4.206613e+000;
n=31; farx(n+1)=1.367896e-001; foe(n+1)=1.390597e+001; krok(n+1)=9.809225e-002; ng(n+1)=8.025376e+000;
n=32; farx(n+1)=9.141655e-002; foe(n+1)=1.150320e+001; krok(n+1)=2.192961e-001; ng(n+1)=3.795356e+001;
n=33; farx(n+1)=8.521135e-002; foe(n+1)=1.184956e+001; krok(n+1)=5.962927e-002; ng(n+1)=3.929642e+001;
n=34; farx(n+1)=6.439788e-002; foe(n+1)=7.678245e+000; krok(n+1)=1.583927e-001; ng(n+1)=2.131926e+001;
n=35; farx(n+1)=5.820984e-002; foe(n+1)=6.082734e+000; krok(n+1)=8.351152e-002; ng(n+1)=2.159558e+001;
n=36; farx(n+1)=5.222638e-002; foe(n+1)=4.433276e+000; krok(n+1)=3.557944e-002; ng(n+1)=2.964583e+001;
n=37; farx(n+1)=4.691330e-002; foe(n+1)=5.157577e+000; krok(n+1)=2.857025e-001; ng(n+1)=5.886826e+000;
n=38; farx(n+1)=4.473442e-002; foe(n+1)=5.143206e+000; krok(n+1)=1.214664e-001; ng(n+1)=3.174751e+000;
n=39; farx(n+1)=4.246522e-002; foe(n+1)=5.358459e+000; krok(n+1)=2.745822e-001; ng(n+1)=5.319470e+000;
n=40; farx(n+1)=3.850980e-002; foe(n+1)=5.604605e+000; krok(n+1)=5.166865e-001; ng(n+1)=1.016899e+001;
n=41; farx(n+1)=3.655213e-002; foe(n+1)=5.634937e+000; krok(n+1)=2.393567e-001; ng(n+1)=1.032555e+001;
n=42; farx(n+1)=3.300678e-002; foe(n+1)=3.843883e+000; krok(n+1)=3.329123e-001; ng(n+1)=7.804911e+000;
n=43; farx(n+1)=3.124092e-002; foe(n+1)=3.273123e+000; krok(n+1)=3.031633e-001; ng(n+1)=6.040371e+000;
n=44; farx(n+1)=2.860147e-002; foe(n+1)=2.878131e+000; krok(n+1)=4.842714e-001; ng(n+1)=4.079984e+000;
n=45; farx(n+1)=2.703429e-002; foe(n+1)=2.410101e+000; krok(n+1)=1.937164e-001; ng(n+1)=1.356060e+001;
n=46; farx(n+1)=2.443972e-002; foe(n+1)=2.366562e+000; krok(n+1)=3.885953e-001; ng(n+1)=7.364501e+000;
n=47; farx(n+1)=2.338553e-002; foe(n+1)=2.140192e+000; krok(n+1)=3.589369e-001; ng(n+1)=2.658125e+000;
n=48; farx(n+1)=2.245393e-002; foe(n+1)=1.870711e+000; krok(n+1)=4.089939e-001; ng(n+1)=8.194625e+000;
n=49; farx(n+1)=2.118256e-002; foe(n+1)=1.905638e+000; krok(n+1)=1.015268e+000; ng(n+1)=4.108072e+000;
n=50; farx(n+1)=2.028994e-002; foe(n+1)=1.947042e+000; krok(n+1)=3.806077e-001; ng(n+1)=3.767941e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.014872e-002; foe(n+1)=1.888798e+000; krok(n+1)=8.898278e-005; ng(n+1)=5.513180e+000;
n=52; farx(n+1)=2.012354e-002; foe(n+1)=1.870841e+000; krok(n+1)=1.297027e-004; ng(n+1)=2.241893e+000;
n=53; farx(n+1)=2.008241e-002; foe(n+1)=1.890111e+000; krok(n+1)=3.032635e-003; ng(n+1)=6.331222e-001;
n=54; farx(n+1)=1.998958e-002; foe(n+1)=1.828039e+000; krok(n+1)=6.446985e-003; ng(n+1)=4.915090e-001;
n=55; farx(n+1)=1.989302e-002; foe(n+1)=1.749346e+000; krok(n+1)=8.402186e-003; ng(n+1)=4.741779e-001;
n=56; farx(n+1)=1.910331e-002; foe(n+1)=1.936887e+000; krok(n+1)=7.101669e-001; ng(n+1)=1.822992e-001;
n=57; farx(n+1)=1.826409e-002; foe(n+1)=1.755802e+000; krok(n+1)=1.365450e-001; ng(n+1)=1.743236e+000;
n=58; farx(n+1)=1.787302e-002; foe(n+1)=1.595594e+000; krok(n+1)=1.934788e-001; ng(n+1)=4.859123e+000;
n=59; farx(n+1)=1.707194e-002; foe(n+1)=1.676798e+000; krok(n+1)=6.287558e-001; ng(n+1)=3.044268e+000;
n=60; farx(n+1)=1.630087e-002; foe(n+1)=1.777169e+000; krok(n+1)=4.714530e-001; ng(n+1)=3.310960e+000;
n=61; farx(n+1)=1.559388e-002; foe(n+1)=1.755749e+000; krok(n+1)=1.794664e-001; ng(n+1)=9.971400e+000;
n=62; farx(n+1)=1.512692e-002; foe(n+1)=1.736686e+000; krok(n+1)=2.357265e-001; ng(n+1)=3.926103e+000;
n=63; farx(n+1)=1.470913e-002; foe(n+1)=1.772038e+000; krok(n+1)=1.292164e-001; ng(n+1)=5.342403e+000;
n=64; farx(n+1)=1.352183e-002; foe(n+1)=1.865145e+000; krok(n+1)=6.239579e-001; ng(n+1)=6.329340e+000;
n=65; farx(n+1)=1.313321e-002; foe(n+1)=1.786748e+000; krok(n+1)=1.934788e-001; ng(n+1)=6.184749e+000;
n=66; farx(n+1)=1.166904e-002; foe(n+1)=1.400334e+000; krok(n+1)=1.120145e+000; ng(n+1)=3.705848e+000;
n=67; farx(n+1)=1.090609e-002; foe(n+1)=1.364853e+000; krok(n+1)=3.713045e-001; ng(n+1)=6.790094e+000;
n=68; farx(n+1)=1.010571e-002; foe(n+1)=1.410259e+000; krok(n+1)=5.013461e-001; ng(n+1)=5.246628e+000;
n=69; farx(n+1)=9.813998e-003; foe(n+1)=1.454086e+000; krok(n+1)=2.507212e-001; ng(n+1)=4.062414e+000;
n=70; farx(n+1)=9.455911e-003; foe(n+1)=1.347378e+000; krok(n+1)=3.276650e-001; ng(n+1)=3.013904e+000;
n=71; farx(n+1)=9.221885e-003; foe(n+1)=1.288272e+000; krok(n+1)=3.077853e-001; ng(n+1)=3.340324e+000;
n=72; farx(n+1)=9.049329e-003; foe(n+1)=1.297177e+000; krok(n+1)=3.505976e-001; ng(n+1)=4.420397e+000;
n=73; farx(n+1)=8.879557e-003; foe(n+1)=1.250297e+000; krok(n+1)=4.448216e-001; ng(n+1)=1.079737e+000;
n=74; farx(n+1)=8.755483e-003; foe(n+1)=1.198046e+000; krok(n+1)=4.923082e-001; ng(n+1)=2.033836e+000;
n=75; farx(n+1)=8.623356e-003; foe(n+1)=1.187380e+000; krok(n+1)=7.310195e-001; ng(n+1)=4.052993e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=8.616368e-003; foe(n+1)=1.198576e+000; krok(n+1)=1.460087e-004; ng(n+1)=1.019155e+000;
n=77; farx(n+1)=8.615995e-003; foe(n+1)=1.198531e+000; krok(n+1)=9.921626e-005; ng(n+1)=3.251696e-001;
n=78; farx(n+1)=8.613846e-003; foe(n+1)=1.192324e+000; krok(n+1)=2.424720e-003; ng(n+1)=1.367627e-001;
n=79; farx(n+1)=8.610282e-003; foe(n+1)=1.203056e+000; krok(n+1)=5.608389e-003; ng(n+1)=1.256631e-001;
n=80; farx(n+1)=8.594126e-003; foe(n+1)=1.205174e+000; krok(n+1)=2.284436e-002; ng(n+1)=1.449098e-001;
n=81; farx(n+1)=8.578655e-003; foe(n+1)=1.174236e+000; krok(n+1)=1.042976e-001; ng(n+1)=6.432586e-002;
n=82; farx(n+1)=8.494980e-003; foe(n+1)=1.206941e+000; krok(n+1)=2.032965e-001; ng(n+1)=9.714099e-002;
n=83; farx(n+1)=8.349293e-003; foe(n+1)=1.118317e+000; krok(n+1)=3.435737e-001; ng(n+1)=2.044220e-001;
n=84; farx(n+1)=8.216526e-003; foe(n+1)=1.057619e+000; krok(n+1)=1.284644e-001; ng(n+1)=1.080618e+000;
n=85; farx(n+1)=8.084717e-003; foe(n+1)=1.020238e+000; krok(n+1)=4.228884e-001; ng(n+1)=4.108494e+000;
n=86; farx(n+1)=8.021716e-003; foe(n+1)=9.660549e-001; krok(n+1)=1.213694e-001; ng(n+1)=1.297999e+000;
n=87; farx(n+1)=7.802720e-003; foe(n+1)=8.923358e-001; krok(n+1)=8.224396e-001; ng(n+1)=2.649643e+000;
n=88; farx(n+1)=7.387523e-003; foe(n+1)=7.841594e-001; krok(n+1)=1.435731e+000; ng(n+1)=1.792984e+000;
n=89; farx(n+1)=7.227349e-003; foe(n+1)=7.719677e-001; krok(n+1)=4.128102e-001; ng(n+1)=2.899228e+000;
n=90; farx(n+1)=7.091700e-003; foe(n+1)=7.677530e-001; krok(n+1)=1.958039e-001; ng(n+1)=3.333418e+000;
n=91; farx(n+1)=6.912082e-003; foe(n+1)=7.855015e-001; krok(n+1)=1.114151e+000; ng(n+1)=5.636761e-001;
n=92; farx(n+1)=6.802831e-003; foe(n+1)=7.463424e-001; krok(n+1)=2.569287e-001; ng(n+1)=2.604107e+000;
n=93; farx(n+1)=6.661773e-003; foe(n+1)=7.186451e-001; krok(n+1)=2.340680e-001; ng(n+1)=2.695167e+000;
n=94; farx(n+1)=6.368602e-003; foe(n+1)=6.575855e-001; krok(n+1)=9.606268e-001; ng(n+1)=3.136611e+000;
n=95; farx(n+1)=6.194774e-003; foe(n+1)=6.230313e-001; krok(n+1)=3.624196e-001; ng(n+1)=2.353185e+000;
n=96; farx(n+1)=6.091474e-003; foe(n+1)=6.522882e-001; krok(n+1)=4.228235e-001; ng(n+1)=1.193129e+000;
n=97; farx(n+1)=5.938254e-003; foe(n+1)=6.757642e-001; krok(n+1)=5.600723e-001; ng(n+1)=1.222341e+000;
n=98; farx(n+1)=5.774840e-003; foe(n+1)=6.971810e-001; krok(n+1)=5.885355e-001; ng(n+1)=1.262228e+000;
n=99; farx(n+1)=5.575637e-003; foe(n+1)=6.789601e-001; krok(n+1)=5.491644e-001; ng(n+1)=3.079733e+000;
n=100; farx(n+1)=5.282953e-003; foe(n+1)=6.462378e-001; krok(n+1)=6.524460e-001; ng(n+1)=1.322816e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
