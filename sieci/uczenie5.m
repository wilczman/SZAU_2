%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.702860e+003; foe(n+1)=2.735673e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.823528e+003; foe(n+1)=1.839936e+003; krok(n+1)=4.898436e-004; ng(n+1)=2.356277e+003;
n=2; farx(n+1)=5.321561e+002; foe(n+1)=5.996156e+002; krok(n+1)=1.299379e-002; ng(n+1)=5.635177e+002;
n=3; farx(n+1)=5.513459e+002; foe(n+1)=5.092595e+002; krok(n+1)=7.130722e-005; ng(n+1)=4.140136e+003;
n=4; farx(n+1)=6.680035e+002; foe(n+1)=4.602102e+002; krok(n+1)=1.951338e-004; ng(n+1)=4.273679e+003;
n=5; farx(n+1)=3.426624e+002; foe(n+1)=3.780609e+002; krok(n+1)=2.223715e-003; ng(n+1)=7.006910e+002;
n=6; farx(n+1)=2.510640e+002; foe(n+1)=3.584836e+002; krok(n+1)=4.939417e-004; ng(n+1)=2.975496e+003;
n=7; farx(n+1)=2.470871e+002; foe(n+1)=3.539321e+002; krok(n+1)=3.395966e-004; ng(n+1)=4.117985e+003;
n=8; farx(n+1)=2.078427e+002; foe(n+1)=3.291580e+002; krok(n+1)=1.016331e-003; ng(n+1)=4.233197e+003;
n=9; farx(n+1)=1.653340e+002; foe(n+1)=3.129790e+002; krok(n+1)=5.018139e-004; ng(n+1)=4.732111e+003;
n=10; farx(n+1)=1.072484e+002; foe(n+1)=2.954170e+002; krok(n+1)=4.743100e-003; ng(n+1)=2.635739e+003;
n=11; farx(n+1)=7.932558e+001; foe(n+1)=2.868868e+002; krok(n+1)=1.402081e-003; ng(n+1)=2.030855e+003;
n=12; farx(n+1)=4.694964e+001; foe(n+1)=2.217560e+002; krok(n+1)=6.042575e-003; ng(n+1)=5.308480e+003;
n=13; farx(n+1)=4.635652e+001; foe(n+1)=2.204848e+002; krok(n+1)=7.114163e-006; ng(n+1)=4.880739e+003;
n=14; farx(n+1)=4.621320e+001; foe(n+1)=2.158718e+002; krok(n+1)=5.636956e-004; ng(n+1)=5.242645e+003;
n=15; farx(n+1)=4.709471e+001; foe(n+1)=2.107183e+002; krok(n+1)=9.053002e-004; ng(n+1)=5.463175e+003;
n=16; farx(n+1)=4.988563e+001; foe(n+1)=2.058026e+002; krok(n+1)=5.404980e-004; ng(n+1)=6.036635e+003;
n=17; farx(n+1)=4.895476e+001; foe(n+1)=1.856839e+002; krok(n+1)=2.885366e-003; ng(n+1)=5.345959e+003;
n=18; farx(n+1)=4.353559e+001; foe(n+1)=1.716991e+002; krok(n+1)=2.145173e-003; ng(n+1)=4.376008e+003;
n=19; farx(n+1)=4.692424e+001; foe(n+1)=1.621420e+002; krok(n+1)=1.524981e-003; ng(n+1)=3.285365e+003;
n=20; farx(n+1)=4.739376e+001; foe(n+1)=1.605000e+002; krok(n+1)=7.663457e-004; ng(n+1)=1.931531e+003;
n=21; farx(n+1)=4.819303e+001; foe(n+1)=1.581401e+002; krok(n+1)=1.468412e-002; ng(n+1)=2.175990e+003;
n=22; farx(n+1)=4.748793e+001; foe(n+1)=1.555778e+002; krok(n+1)=5.381741e-003; ng(n+1)=2.268584e+003;
n=23; farx(n+1)=4.408576e+001; foe(n+1)=1.372383e+002; krok(n+1)=6.778645e-002; ng(n+1)=2.378088e+003;
n=24; farx(n+1)=3.392745e+001; foe(n+1)=1.081302e+002; krok(n+1)=7.780615e-002; ng(n+1)=1.224941e+003;
n=25; farx(n+1)=3.506523e+001; foe(n+1)=1.037022e+002; krok(n+1)=1.706649e-002; ng(n+1)=1.990841e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.514057e+001; foe(n+1)=1.015211e+002; krok(n+1)=2.277085e-005; ng(n+1)=1.276705e+003;
n=27; farx(n+1)=3.364037e+001; foe(n+1)=9.503064e+001; krok(n+1)=2.663397e-005; ng(n+1)=1.733413e+003;
n=28; farx(n+1)=3.162187e+001; foe(n+1)=8.915929e+001; krok(n+1)=2.832743e-005; ng(n+1)=1.514412e+003;
n=29; farx(n+1)=2.815753e+001; foe(n+1)=7.366104e+001; krok(n+1)=1.180993e-004; ng(n+1)=1.701156e+003;
n=30; farx(n+1)=2.746921e+001; foe(n+1)=6.842549e+001; krok(n+1)=1.915864e-004; ng(n+1)=1.489665e+003;
n=31; farx(n+1)=2.552136e+001; foe(n+1)=5.585132e+001; krok(n+1)=9.053002e-004; ng(n+1)=1.651328e+003;
n=32; farx(n+1)=2.333815e+001; foe(n+1)=4.905478e+001; krok(n+1)=6.100243e-004; ng(n+1)=3.907787e+003;
n=33; farx(n+1)=2.134010e+001; foe(n+1)=4.404403e+001; krok(n+1)=1.350546e-003; ng(n+1)=1.229153e+003;
n=34; farx(n+1)=1.990228e+001; foe(n+1)=4.015883e+001; krok(n+1)=4.663178e-003; ng(n+1)=2.693276e+003;
n=35; farx(n+1)=1.828593e+001; foe(n+1)=3.725366e+001; krok(n+1)=1.427772e-003; ng(n+1)=1.843776e+003;
n=36; farx(n+1)=1.694900e+001; foe(n+1)=3.529536e+001; krok(n+1)=1.841613e-003; ng(n+1)=1.670184e+003;
n=37; farx(n+1)=1.704510e+001; foe(n+1)=3.011238e+001; krok(n+1)=7.029269e-003; ng(n+1)=2.917852e+003;
n=38; farx(n+1)=1.769355e+001; foe(n+1)=2.792530e+001; krok(n+1)=8.897443e-004; ng(n+1)=1.923073e+003;
n=39; farx(n+1)=1.827315e+001; foe(n+1)=2.597013e+001; krok(n+1)=4.352152e-003; ng(n+1)=2.219859e+003;
n=40; farx(n+1)=1.535084e+001; foe(n+1)=2.297721e+001; krok(n+1)=2.439969e-002; ng(n+1)=1.257921e+003;
n=41; farx(n+1)=1.300884e+001; foe(n+1)=2.089709e+001; krok(n+1)=8.468065e-003; ng(n+1)=1.918367e+003;
n=42; farx(n+1)=1.146139e+001; foe(n+1)=1.865023e+001; krok(n+1)=1.402081e-003; ng(n+1)=9.642053e+002;
n=43; farx(n+1)=1.005880e+001; foe(n+1)=1.734846e+001; krok(n+1)=4.944619e-003; ng(n+1)=5.010662e+002;
n=44; farx(n+1)=8.580399e+000; foe(n+1)=1.567134e+001; krok(n+1)=3.022871e-002; ng(n+1)=5.652281e+002;
n=45; farx(n+1)=7.711711e+000; foe(n+1)=1.458489e+001; krok(n+1)=3.229291e-002; ng(n+1)=6.298894e+002;
n=46; farx(n+1)=5.406445e+000; foe(n+1)=1.260493e+001; krok(n+1)=6.024636e-002; ng(n+1)=8.819888e+002;
n=47; farx(n+1)=3.411993e+000; foe(n+1)=1.047607e+001; krok(n+1)=2.741202e-002; ng(n+1)=1.156683e+003;
n=48; farx(n+1)=2.760360e+000; foe(n+1)=9.504260e+000; krok(n+1)=9.569438e-002; ng(n+1)=1.157784e+003;
n=49; farx(n+1)=2.375024e+000; foe(n+1)=7.652004e+000; krok(n+1)=3.745525e-001; ng(n+1)=5.347610e+002;
n=50; farx(n+1)=1.768272e+000; foe(n+1)=5.891331e+000; krok(n+1)=7.612154e-001; ng(n+1)=1.284069e+003;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.774238e+000; foe(n+1)=5.413717e+000; krok(n+1)=3.467514e-006; ng(n+1)=1.462729e+003;
n=52; farx(n+1)=1.773705e+000; foe(n+1)=5.328519e+000; krok(n+1)=1.245057e-005; ng(n+1)=3.026269e+002;
n=53; farx(n+1)=1.752701e+000; foe(n+1)=5.268437e+000; krok(n+1)=1.131625e-004; ng(n+1)=1.026412e+002;
n=54; farx(n+1)=1.764435e+000; foe(n+1)=5.048984e+000; krok(n+1)=7.559922e-004; ng(n+1)=7.931052e+001;
n=55; farx(n+1)=1.754758e+000; foe(n+1)=4.967730e+000; krok(n+1)=1.688183e-004; ng(n+1)=1.010009e+002;
n=56; farx(n+1)=1.717502e+000; foe(n+1)=4.551841e+000; krok(n+1)=4.323984e-003; ng(n+1)=6.540216e+001;
n=57; farx(n+1)=1.668173e+000; foe(n+1)=4.292833e+000; krok(n+1)=2.075244e-003; ng(n+1)=2.162252e+002;
n=58; farx(n+1)=1.510977e+000; foe(n+1)=4.077861e+000; krok(n+1)=4.258262e-003; ng(n+1)=3.229042e+002;
n=59; farx(n+1)=1.459831e+000; foe(n+1)=3.915036e+000; krok(n+1)=1.196180e-002; ng(n+1)=4.669175e+002;
n=60; farx(n+1)=1.389267e+000; foe(n+1)=3.508384e+000; krok(n+1)=2.362755e-002; ng(n+1)=3.735996e+002;
n=61; farx(n+1)=1.373404e+000; foe(n+1)=3.281549e+000; krok(n+1)=2.183177e-002; ng(n+1)=2.361369e+002;
n=62; farx(n+1)=1.379676e+000; foe(n+1)=3.218429e+000; krok(n+1)=3.625910e-003; ng(n+1)=4.033330e+002;
n=63; farx(n+1)=1.291196e+000; foe(n+1)=3.104475e+000; krok(n+1)=1.518514e-002; ng(n+1)=2.764424e+002;
n=64; farx(n+1)=1.281545e+000; foe(n+1)=2.907050e+000; krok(n+1)=4.050274e-002; ng(n+1)=2.692969e+002;
n=65; farx(n+1)=1.192654e+000; foe(n+1)=2.728437e+000; krok(n+1)=3.663964e-002; ng(n+1)=5.048353e+002;
n=66; farx(n+1)=1.085743e+000; foe(n+1)=2.608932e+000; krok(n+1)=1.226153e-002; ng(n+1)=1.725044e+002;
n=67; farx(n+1)=1.043988e+000; foe(n+1)=2.531935e+000; krok(n+1)=2.272397e-002; ng(n+1)=1.609923e+002;
n=68; farx(n+1)=9.580855e-001; foe(n+1)=2.328118e+000; krok(n+1)=8.005809e-002; ng(n+1)=5.942289e+002;
n=69; farx(n+1)=8.778820e-001; foe(n+1)=2.084566e+000; krok(n+1)=1.340624e-001; ng(n+1)=2.130674e+002;
n=70; farx(n+1)=8.318993e-001; foe(n+1)=2.036336e+000; krok(n+1)=3.276344e-002; ng(n+1)=3.907502e+002;
n=71; farx(n+1)=8.099219e-001; foe(n+1)=1.992480e+000; krok(n+1)=3.737824e-002; ng(n+1)=3.546083e+002;
n=72; farx(n+1)=6.743545e-001; foe(n+1)=1.881503e+000; krok(n+1)=1.951976e-001; ng(n+1)=1.885450e+002;
n=73; farx(n+1)=6.788356e-001; foe(n+1)=1.794902e+000; krok(n+1)=2.041642e-001; ng(n+1)=1.141039e+002;
n=74; farx(n+1)=7.580234e-001; foe(n+1)=1.725448e+000; krok(n+1)=1.344556e-001; ng(n+1)=3.918419e+002;
n=75; farx(n+1)=6.913998e-001; foe(n+1)=1.600157e+000; krok(n+1)=2.680018e-001; ng(n+1)=9.622465e+001;
%odnowa zmiennej metryki
n=76; farx(n+1)=6.914426e-001; foe(n+1)=1.572500e+000; krok(n+1)=1.955462e-006; ng(n+1)=4.665476e+002;
n=77; farx(n+1)=6.904412e-001; foe(n+1)=1.565511e+000; krok(n+1)=7.156975e-006; ng(n+1)=1.147087e+002;
n=78; farx(n+1)=6.915346e-001; foe(n+1)=1.557309e+000; krok(n+1)=5.658127e-005; ng(n+1)=5.214513e+001;
n=79; farx(n+1)=6.885823e-001; foe(n+1)=1.548409e+000; krok(n+1)=2.478815e-004; ng(n+1)=2.842113e+001;
n=80; farx(n+1)=6.848420e-001; foe(n+1)=1.531556e+000; krok(n+1)=2.460936e-004; ng(n+1)=3.534900e+001;
n=81; farx(n+1)=6.802462e-001; foe(n+1)=1.496608e+000; krok(n+1)=7.504897e-003; ng(n+1)=1.020917e+001;
n=82; farx(n+1)=6.811208e-001; foe(n+1)=1.479748e+000; krok(n+1)=1.038427e-003; ng(n+1)=3.192296e+001;
n=83; farx(n+1)=6.843328e-001; foe(n+1)=1.432520e+000; krok(n+1)=3.303815e-003; ng(n+1)=5.236185e+001;
n=84; farx(n+1)=6.657586e-001; foe(n+1)=1.417932e+000; krok(n+1)=3.990929e-003; ng(n+1)=3.384868e+002;
n=85; farx(n+1)=6.397451e-001; foe(n+1)=1.393405e+000; krok(n+1)=1.991120e-002; ng(n+1)=5.230982e+002;
n=86; farx(n+1)=6.191637e-001; foe(n+1)=1.365804e+000; krok(n+1)=1.626130e-002; ng(n+1)=4.007356e+002;
n=87; farx(n+1)=5.616650e-001; foe(n+1)=1.333912e+000; krok(n+1)=3.879553e-002; ng(n+1)=2.787656e+002;
n=88; farx(n+1)=5.520167e-001; foe(n+1)=1.315191e+000; krok(n+1)=2.556212e-002; ng(n+1)=2.447758e+002;
n=89; farx(n+1)=5.561349e-001; foe(n+1)=1.300271e+000; krok(n+1)=1.486332e-002; ng(n+1)=2.166643e+002;
n=90; farx(n+1)=5.521391e-001; foe(n+1)=1.294634e+000; krok(n+1)=1.260621e-002; ng(n+1)=1.120347e+002;
n=91; farx(n+1)=5.530858e-001; foe(n+1)=1.284210e+000; krok(n+1)=3.450322e-002; ng(n+1)=1.405526e+002;
n=92; farx(n+1)=6.002818e-001; foe(n+1)=1.251407e+000; krok(n+1)=1.191056e-001; ng(n+1)=1.370686e+002;
n=93; farx(n+1)=5.761083e-001; foe(n+1)=1.231386e+000; krok(n+1)=5.184392e-002; ng(n+1)=2.182440e+002;
n=94; farx(n+1)=4.985924e-001; foe(n+1)=1.195271e+000; krok(n+1)=1.036878e-001; ng(n+1)=1.519073e+002;
n=95; farx(n+1)=4.792584e-001; foe(n+1)=1.172741e+000; krok(n+1)=6.189726e-002; ng(n+1)=2.295195e+002;
n=96; farx(n+1)=4.651538e-001; foe(n+1)=1.145792e+000; krok(n+1)=4.288049e-001; ng(n+1)=3.641333e+002;
n=97; farx(n+1)=4.652577e-001; foe(n+1)=1.119226e+000; krok(n+1)=1.537931e-001; ng(n+1)=3.689281e+002;
n=98; farx(n+1)=4.403999e-001; foe(n+1)=1.075934e+000; krok(n+1)=3.435737e-001; ng(n+1)=2.521782e+002;
n=99; farx(n+1)=4.227349e-001; foe(n+1)=1.049844e+000; krok(n+1)=1.204927e-001; ng(n+1)=1.322148e+002;
n=100; farx(n+1)=4.059005e-001; foe(n+1)=1.022719e+000; krok(n+1)=1.937164e-001; ng(n+1)=1.263741e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
