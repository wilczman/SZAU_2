%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.806898e+003; foe(n+1)=2.910891e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.057729e+003; foe(n+1)=1.820985e+003; krok(n+1)=4.898436e-004; ng(n+1)=6.901706e+003;
n=2; farx(n+1)=5.530239e+002; foe(n+1)=4.141570e+003; krok(n+1)=3.550621e-004; ng(n+1)=6.194010e+003;
n=3; farx(n+1)=1.152006e+002; foe(n+1)=2.091090e+003; krok(n+1)=7.805354e-004; ng(n+1)=3.445038e+003;
n=4; farx(n+1)=4.166551e+001; foe(n+1)=3.835425e+003; krok(n+1)=4.234033e-003; ng(n+1)=4.423089e+003;
n=5; farx(n+1)=2.214257e+001; foe(n+1)=5.417801e+003; krok(n+1)=3.096185e-003; ng(n+1)=1.386743e+003;
n=6; farx(n+1)=1.398911e+001; foe(n+1)=5.131876e+003; krok(n+1)=2.899547e-003; ng(n+1)=8.500549e+002;
n=7; farx(n+1)=8.351835e+000; foe(n+1)=3.398326e+002; krok(n+1)=3.739948e-003; ng(n+1)=3.190770e+002;
n=8; farx(n+1)=4.728510e+000; foe(n+1)=1.846874e+002; krok(n+1)=5.119766e-003; ng(n+1)=8.626185e+002;
n=9; farx(n+1)=3.455927e+000; foe(n+1)=1.331407e+002; krok(n+1)=2.962391e-003; ng(n+1)=2.277535e+002;
n=10; farx(n+1)=2.224988e+000; foe(n+1)=9.563799e+001; krok(n+1)=4.111242e-002; ng(n+1)=1.303955e+002;
n=11; farx(n+1)=2.013710e+000; foe(n+1)=1.101860e+002; krok(n+1)=1.042882e-002; ng(n+1)=1.295281e+002;
n=12; farx(n+1)=1.827187e+000; foe(n+1)=7.733221e+001; krok(n+1)=2.001452e-002; ng(n+1)=1.322241e+002;
n=13; farx(n+1)=1.620952e+000; foe(n+1)=8.014393e+001; krok(n+1)=4.102628e-002; ng(n+1)=1.452284e+002;
n=14; farx(n+1)=1.343225e+000; foe(n+1)=7.091975e+001; krok(n+1)=9.464413e-002; ng(n+1)=1.670235e+002;
n=15; farx(n+1)=1.170995e+000; foe(n+1)=9.360527e+001; krok(n+1)=4.242564e-002; ng(n+1)=1.046031e+002;
n=16; farx(n+1)=1.022407e+000; foe(n+1)=1.140711e+002; krok(n+1)=2.308292e-002; ng(n+1)=1.034093e+002;
n=17; farx(n+1)=8.178872e-001; foe(n+1)=1.180482e+002; krok(n+1)=5.140248e-002; ng(n+1)=5.393789e+001;
n=18; farx(n+1)=6.850992e-001; foe(n+1)=9.448233e+001; krok(n+1)=1.150658e-001; ng(n+1)=1.109334e+002;
n=19; farx(n+1)=5.793215e-001; foe(n+1)=1.427907e+002; krok(n+1)=6.306675e-002; ng(n+1)=3.853405e+001;
n=20; farx(n+1)=5.305766e-001; foe(n+1)=1.484162e+002; krok(n+1)=6.533169e-002; ng(n+1)=1.020898e+002;
n=21; farx(n+1)=4.985537e-001; foe(n+1)=1.736557e+002; krok(n+1)=1.362955e-001; ng(n+1)=3.671794e+001;
n=22; farx(n+1)=4.302607e-001; foe(n+1)=1.600803e+002; krok(n+1)=1.577575e-001; ng(n+1)=2.579907e+001;
n=23; farx(n+1)=3.988587e-001; foe(n+1)=2.119732e+002; krok(n+1)=1.204927e-001; ng(n+1)=2.761449e+001;
n=24; farx(n+1)=3.831500e-001; foe(n+1)=2.900329e+002; krok(n+1)=9.809225e-002; ng(n+1)=3.867813e+001;
n=25; farx(n+1)=3.270744e-001; foe(n+1)=2.316354e+002; krok(n+1)=3.054682e-001; ng(n+1)=3.400408e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.200210e-001; foe(n+1)=2.529538e+002; krok(n+1)=1.470238e-004; ng(n+1)=3.548192e+001;
n=27; farx(n+1)=3.170963e-001; foe(n+1)=2.532240e+002; krok(n+1)=1.524890e-004; ng(n+1)=2.521854e+001;
n=28; farx(n+1)=3.083455e-001; foe(n+1)=1.690529e+002; krok(n+1)=2.324948e-003; ng(n+1)=1.081805e+001;
n=29; farx(n+1)=2.395693e-001; foe(n+1)=1.596636e+002; krok(n+1)=3.847317e-002; ng(n+1)=6.891619e+000;
n=30; farx(n+1)=2.008522e-001; foe(n+1)=1.146076e+002; krok(n+1)=1.363820e-002; ng(n+1)=4.690802e+001;
n=31; farx(n+1)=1.595314e-001; foe(n+1)=7.766651e+001; krok(n+1)=1.116954e-001; ng(n+1)=1.037955e+002;
n=32; farx(n+1)=1.232206e-001; foe(n+1)=2.740497e+001; krok(n+1)=8.569436e-002; ng(n+1)=3.463873e+001;
n=33; farx(n+1)=1.147804e-001; foe(n+1)=2.481056e+001; krok(n+1)=5.671128e-002; ng(n+1)=1.715897e+001;
n=34; farx(n+1)=1.004416e-001; foe(n+1)=3.055083e+001; krok(n+1)=1.144404e-001; ng(n+1)=2.731436e+001;
n=35; farx(n+1)=9.600426e-002; foe(n+1)=2.734186e+001; krok(n+1)=2.946581e-002; ng(n+1)=1.824316e+001;
n=36; farx(n+1)=8.526081e-002; foe(n+1)=2.643571e+001; krok(n+1)=2.800362e-001; ng(n+1)=2.109698e+001;
n=37; farx(n+1)=7.954005e-002; foe(n+1)=2.413358e+001; krok(n+1)=1.241227e-001; ng(n+1)=1.469255e+001;
n=38; farx(n+1)=7.671642e-002; foe(n+1)=1.955044e+001; krok(n+1)=1.551821e-001; ng(n+1)=1.157862e+001;
n=39; farx(n+1)=7.138283e-002; foe(n+1)=1.778260e+001; krok(n+1)=2.921091e-001; ng(n+1)=1.060321e+001;
n=40; farx(n+1)=6.448982e-002; foe(n+1)=2.017731e+001; krok(n+1)=3.038513e-001; ng(n+1)=1.092222e+001;
n=41; farx(n+1)=6.275058e-002; foe(n+1)=1.931861e+001; krok(n+1)=6.679426e-002; ng(n+1)=2.037419e+001;
n=42; farx(n+1)=5.872934e-002; foe(n+1)=1.761071e+001; krok(n+1)=1.807191e-001; ng(n+1)=1.624669e+001;
n=43; farx(n+1)=5.423578e-002; foe(n+1)=1.095100e+001; krok(n+1)=2.522670e-001; ng(n+1)=7.293338e+000;
n=44; farx(n+1)=4.861931e-002; foe(n+1)=7.896449e+000; krok(n+1)=3.114411e-001; ng(n+1)=2.454210e+001;
n=45; farx(n+1)=4.228202e-002; foe(n+1)=6.863403e+000; krok(n+1)=3.655097e-001; ng(n+1)=5.023208e+000;
n=46; farx(n+1)=3.900433e-002; foe(n+1)=6.134698e+000; krok(n+1)=9.809225e-002; ng(n+1)=1.272399e+001;
n=47; farx(n+1)=3.547094e-002; foe(n+1)=6.237962e+000; krok(n+1)=1.778431e-001; ng(n+1)=1.948797e+001;
n=48; farx(n+1)=3.298459e-002; foe(n+1)=4.348537e+000; krok(n+1)=1.178633e-001; ng(n+1)=8.747066e+000;
n=49; farx(n+1)=3.150563e-002; foe(n+1)=3.748661e+000; krok(n+1)=2.211882e-001; ng(n+1)=1.158170e+001;
n=50; farx(n+1)=2.996272e-002; foe(n+1)=3.968823e+000; krok(n+1)=2.601236e-001; ng(n+1)=3.271167e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.957626e-002; foe(n+1)=3.731614e+000; krok(n+1)=1.992091e-004; ng(n+1)=7.946770e+000;
n=52; farx(n+1)=2.957037e-002; foe(n+1)=3.737740e+000; krok(n+1)=1.107642e-004; ng(n+1)=1.223084e+000;
n=53; farx(n+1)=2.945634e-002; foe(n+1)=3.623762e+000; krok(n+1)=2.774090e-003; ng(n+1)=1.198687e+000;
n=54; farx(n+1)=2.933713e-002; foe(n+1)=3.564529e+000; krok(n+1)=4.027729e-003; ng(n+1)=8.952648e-001;
n=55; farx(n+1)=2.879811e-002; foe(n+1)=3.871061e+000; krok(n+1)=4.438543e-002; ng(n+1)=5.583462e-001;
n=56; farx(n+1)=2.805059e-002; foe(n+1)=3.392941e+000; krok(n+1)=1.181740e-001; ng(n+1)=4.591343e-001;
n=57; farx(n+1)=2.549055e-002; foe(n+1)=3.594111e+000; krok(n+1)=3.510640e-001; ng(n+1)=5.546010e-001;
n=58; farx(n+1)=2.492685e-002; foe(n+1)=3.725126e+000; krok(n+1)=1.052242e-001; ng(n+1)=1.053824e+001;
n=59; farx(n+1)=2.391933e-002; foe(n+1)=3.813764e+000; krok(n+1)=3.839848e-001; ng(n+1)=3.132083e+000;
n=60; farx(n+1)=2.036926e-002; foe(n+1)=3.394177e+000; krok(n+1)=1.903039e-001; ng(n+1)=1.358766e+001;
n=61; farx(n+1)=1.888882e-002; foe(n+1)=3.421998e+000; krok(n+1)=2.935451e-001; ng(n+1)=1.129099e+001;
n=62; farx(n+1)=1.590638e-002; foe(n+1)=2.165462e+000; krok(n+1)=3.806077e-001; ng(n+1)=6.984064e+000;
n=63; farx(n+1)=1.539473e-002; foe(n+1)=2.028079e+000; krok(n+1)=6.690246e-002; ng(n+1)=6.487957e+000;
n=64; farx(n+1)=1.494909e-002; foe(n+1)=1.996959e+000; krok(n+1)=2.442288e-001; ng(n+1)=3.163365e+000;
n=65; farx(n+1)=1.424105e-002; foe(n+1)=1.970939e+000; krok(n+1)=3.923690e-001; ng(n+1)=1.852504e+000;
n=66; farx(n+1)=1.393666e-002; foe(n+1)=1.938541e+000; krok(n+1)=2.367770e-001; ng(n+1)=4.929217e+000;
n=67; farx(n+1)=1.302196e-002; foe(n+1)=1.866833e+000; krok(n+1)=7.273018e-001; ng(n+1)=3.547771e+000;
n=68; farx(n+1)=1.242985e-002; foe(n+1)=2.028046e+000; krok(n+1)=6.077026e-001; ng(n+1)=3.769878e+000;
n=69; farx(n+1)=1.201931e-002; foe(n+1)=1.827772e+000; krok(n+1)=4.187571e-001; ng(n+1)=4.133959e+000;
n=70; farx(n+1)=1.179709e-002; foe(n+1)=1.748618e+000; krok(n+1)=2.583432e-001; ng(n+1)=3.099963e+000;
n=71; farx(n+1)=1.160567e-002; foe(n+1)=1.712692e+000; krok(n+1)=4.681360e-001; ng(n+1)=2.427722e+000;
n=72; farx(n+1)=1.147609e-002; foe(n+1)=1.706834e+000; krok(n+1)=3.916078e-001; ng(n+1)=3.099259e+000;
n=73; farx(n+1)=1.126284e-002; foe(n+1)=1.693772e+000; krok(n+1)=1.120145e+000; ng(n+1)=2.717354e+000;
n=74; farx(n+1)=1.110316e-002; foe(n+1)=1.541862e+000; krok(n+1)=8.088973e-001; ng(n+1)=2.059534e+000;
n=75; farx(n+1)=1.068233e-002; foe(n+1)=1.557371e+000; krok(n+1)=2.560234e+000; ng(n+1)=1.063627e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.063886e-002; foe(n+1)=1.548923e+000; krok(n+1)=6.485137e-005; ng(n+1)=4.536120e+000;
n=77; farx(n+1)=1.062941e-002; foe(n+1)=1.524167e+000; krok(n+1)=1.897731e-004; ng(n+1)=1.001360e+000;
n=78; farx(n+1)=1.060966e-002; foe(n+1)=1.514393e+000; krok(n+1)=3.572501e-003; ng(n+1)=4.117512e-001;
n=79; farx(n+1)=1.057277e-002; foe(n+1)=1.481126e+000; krok(n+1)=5.548179e-003; ng(n+1)=4.609858e-001;
n=80; farx(n+1)=1.055096e-002; foe(n+1)=1.448259e+000; krok(n+1)=7.598245e-003; ng(n+1)=2.910139e-001;
n=81; farx(n+1)=1.052030e-002; foe(n+1)=1.466021e+000; krok(n+1)=1.027179e-001; ng(n+1)=1.019212e-001;
n=82; farx(n+1)=1.032148e-002; foe(n+1)=1.469096e+000; krok(n+1)=6.081435e-001; ng(n+1)=1.128714e-001;
n=83; farx(n+1)=1.029083e-002; foe(n+1)=1.467808e+000; krok(n+1)=1.317940e-001; ng(n+1)=3.230621e-001;
n=84; farx(n+1)=1.018149e-002; foe(n+1)=1.339717e+000; krok(n+1)=3.319551e-001; ng(n+1)=3.063287e-001;
n=85; farx(n+1)=1.015999e-002; foe(n+1)=1.308316e+000; krok(n+1)=9.990853e-002; ng(n+1)=1.426334e-001;
n=86; farx(n+1)=9.833190e-003; foe(n+1)=1.233197e+000; krok(n+1)=2.278251e+000; ng(n+1)=1.475688e-001;
n=87; farx(n+1)=9.637500e-003; foe(n+1)=1.195612e+000; krok(n+1)=6.809733e-001; ng(n+1)=4.080999e+000;
n=88; farx(n+1)=9.476686e-003; foe(n+1)=1.186039e+000; krok(n+1)=3.655097e-001; ng(n+1)=3.549753e+000;
n=89; farx(n+1)=9.309632e-003; foe(n+1)=1.190351e+000; krok(n+1)=1.250289e+000; ng(n+1)=2.889102e+000;
n=90; farx(n+1)=9.130363e-003; foe(n+1)=1.131625e+000; krok(n+1)=7.571530e-001; ng(n+1)=3.013939e+000;
n=91; farx(n+1)=8.926297e-003; foe(n+1)=1.043282e+000; krok(n+1)=3.806077e-001; ng(n+1)=3.002698e+000;
n=92; farx(n+1)=8.699971e-003; foe(n+1)=1.063204e+000; krok(n+1)=6.954939e-001; ng(n+1)=4.481107e+000;
n=93; farx(n+1)=8.473359e-003; foe(n+1)=1.015232e+000; krok(n+1)=6.322648e-001; ng(n+1)=5.095026e+000;
n=94; farx(n+1)=8.179121e-003; foe(n+1)=8.963344e-001; krok(n+1)=8.812470e-001; ng(n+1)=1.722628e+000;
n=95; farx(n+1)=7.991918e-003; foe(n+1)=8.067013e-001; krok(n+1)=3.923690e-001; ng(n+1)=3.040758e+000;
n=96; farx(n+1)=7.600540e-003; foe(n+1)=7.094659e-001; krok(n+1)=5.571345e-001; ng(n+1)=4.940322e+000;
n=97; farx(n+1)=7.391863e-003; foe(n+1)=7.594512e-001; krok(n+1)=2.818076e-001; ng(n+1)=1.738999e+000;
n=98; farx(n+1)=7.169424e-003; foe(n+1)=7.234427e-001; krok(n+1)=2.833785e-001; ng(n+1)=1.656871e+000;
n=99; farx(n+1)=6.863349e-003; foe(n+1)=6.802613e-001; krok(n+1)=7.271671e-001; ng(n+1)=1.714646e+000;
n=100; farx(n+1)=6.755932e-003; foe(n+1)=6.704422e-001; krok(n+1)=4.268310e-001; ng(n+1)=3.264812e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
