%uczenie predyktora oe
clear all;
n=0; farx(n+1)=2.694869e+003; foe(n+1)=2.698296e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=1.815043e+003; foe(n+1)=1.797443e+003; krok(n+1)=4.927090e-004; ng(n+1)=2.813653e+003;
n=2; farx(n+1)=7.232483e+002; foe(n+1)=7.302549e+002; krok(n+1)=4.714228e-003; ng(n+1)=9.577269e+002;
n=3; farx(n+1)=7.657031e+002; foe(n+1)=6.631877e+002; krok(n+1)=9.579321e-005; ng(n+1)=4.470187e+003;
n=4; farx(n+1)=1.515329e+003; foe(n+1)=5.578928e+002; krok(n+1)=1.137064e-003; ng(n+1)=5.726909e+003;
n=5; farx(n+1)=1.408135e+003; foe(n+1)=5.233426e+002; krok(n+1)=4.800362e-003; ng(n+1)=7.116067e+002;
n=6; farx(n+1)=1.317637e+003; foe(n+1)=5.057752e+002; krok(n+1)=2.900817e-003; ng(n+1)=1.410224e+003;
n=7; farx(n+1)=1.206262e+003; foe(n+1)=5.001344e+002; krok(n+1)=1.276921e-003; ng(n+1)=1.509617e+003;
n=8; farx(n+1)=2.252766e+002; foe(n+1)=3.230792e+002; krok(n+1)=4.704763e-003; ng(n+1)=1.845945e+003;
n=9; farx(n+1)=2.113404e+002; foe(n+1)=3.216697e+002; krok(n+1)=2.277170e-005; ng(n+1)=2.537734e+003;
n=10; farx(n+1)=2.055490e+002; foe(n+1)=3.180786e+002; krok(n+1)=9.053002e-004; ng(n+1)=3.620149e+003;
n=11; farx(n+1)=2.121127e+002; foe(n+1)=3.118314e+002; krok(n+1)=3.692938e-003; ng(n+1)=2.672615e+003;
n=12; farx(n+1)=2.104441e+002; foe(n+1)=3.093692e+002; krok(n+1)=2.804162e-003; ng(n+1)=1.405174e+003;
n=13; farx(n+1)=2.099710e+002; foe(n+1)=3.055942e+002; krok(n+1)=1.970836e-003; ng(n+1)=1.085059e+003;
n=14; farx(n+1)=1.924528e+002; foe(n+1)=2.988954e+002; krok(n+1)=2.454245e-003; ng(n+1)=1.248366e+003;
n=15; farx(n+1)=1.632990e+002; foe(n+1)=2.801681e+002; krok(n+1)=1.737095e-002; ng(n+1)=1.721649e+003;
n=16; farx(n+1)=1.552939e+002; foe(n+1)=2.599885e+002; krok(n+1)=3.040595e-003; ng(n+1)=1.484111e+003;
n=17; farx(n+1)=2.430985e+002; foe(n+1)=1.883451e+002; krok(n+1)=7.191676e-003; ng(n+1)=2.443746e+003;
n=18; farx(n+1)=2.462706e+002; foe(n+1)=1.876035e+002; krok(n+1)=8.074766e-005; ng(n+1)=2.148997e+003;
n=19; farx(n+1)=2.507919e+002; foe(n+1)=1.844281e+002; krok(n+1)=3.765398e-003; ng(n+1)=2.251885e+003;
n=20; farx(n+1)=2.568398e+002; foe(n+1)=1.782603e+002; krok(n+1)=3.146871e-003; ng(n+1)=1.695081e+003;
n=21; farx(n+1)=2.518492e+002; foe(n+1)=1.755102e+002; krok(n+1)=2.320282e-003; ng(n+1)=2.414465e+003;
n=22; farx(n+1)=2.362916e+002; foe(n+1)=1.572358e+002; krok(n+1)=2.840497e-003; ng(n+1)=4.433811e+003;
n=23; farx(n+1)=2.381266e+002; foe(n+1)=1.537064e+002; krok(n+1)=1.130654e-003; ng(n+1)=6.061117e+003;
n=24; farx(n+1)=2.362481e+002; foe(n+1)=1.517641e+002; krok(n+1)=1.160015e-003; ng(n+1)=5.192546e+003;
n=25; farx(n+1)=2.517588e+002; foe(n+1)=1.392310e+002; krok(n+1)=2.024365e-002; ng(n+1)=8.050828e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.503963e+002; foe(n+1)=1.373273e+002; krok(n+1)=2.689353e-006; ng(n+1)=4.465639e+003;
n=27; farx(n+1)=2.212409e+002; foe(n+1)=1.271782e+002; krok(n+1)=8.559513e-005; ng(n+1)=1.408737e+003;
n=28; farx(n+1)=1.957391e+002; foe(n+1)=1.144824e+002; krok(n+1)=1.059505e-004; ng(n+1)=2.051137e+003;
n=29; farx(n+1)=1.675947e+002; foe(n+1)=1.028197e+002; krok(n+1)=1.156009e-003; ng(n+1)=3.558531e+003;
n=30; farx(n+1)=1.319155e+002; foe(n+1)=9.369681e+001; krok(n+1)=1.024167e-003; ng(n+1)=2.573267e+003;
n=31; farx(n+1)=1.060985e+002; foe(n+1)=8.645655e+001; krok(n+1)=1.532691e-003; ng(n+1)=5.020897e+003;
n=32; farx(n+1)=6.489654e+001; foe(n+1)=7.321664e+001; krok(n+1)=1.093065e-003; ng(n+1)=2.619638e+003;
n=33; farx(n+1)=5.793760e+001; foe(n+1)=6.986495e+001; krok(n+1)=1.508794e-003; ng(n+1)=1.120261e+003;
n=34; farx(n+1)=4.686669e+001; foe(n+1)=6.586676e+001; krok(n+1)=4.515039e-003; ng(n+1)=3.461117e+003;
n=35; farx(n+1)=3.440342e+001; foe(n+1)=6.013262e+001; krok(n+1)=2.484848e-003; ng(n+1)=1.710210e+003;
n=36; farx(n+1)=2.701110e+001; foe(n+1)=5.506485e+001; krok(n+1)=1.478815e-003; ng(n+1)=4.686995e+003;
n=37; farx(n+1)=2.484885e+001; foe(n+1)=4.715165e+001; krok(n+1)=3.990004e-003; ng(n+1)=3.383402e+003;
n=38; farx(n+1)=1.941310e+001; foe(n+1)=4.238854e+001; krok(n+1)=5.214412e-003; ng(n+1)=7.068498e+002;
n=39; farx(n+1)=1.762016e+001; foe(n+1)=4.116017e+001; krok(n+1)=2.110724e-003; ng(n+1)=5.945815e+002;
n=40; farx(n+1)=1.397162e+001; foe(n+1)=3.839194e+001; krok(n+1)=4.162174e-003; ng(n+1)=9.251235e+002;
n=41; farx(n+1)=1.048951e+001; foe(n+1)=3.381066e+001; krok(n+1)=4.546520e-003; ng(n+1)=1.854981e+003;
n=42; farx(n+1)=8.716967e+000; foe(n+1)=3.126683e+001; krok(n+1)=2.813867e-003; ng(n+1)=1.421554e+003;
n=43; farx(n+1)=6.598593e+000; foe(n+1)=2.834819e+001; krok(n+1)=4.884963e-003; ng(n+1)=2.389828e+003;
n=44; farx(n+1)=5.941172e+000; foe(n+1)=2.724094e+001; krok(n+1)=1.220118e-002; ng(n+1)=3.331857e+003;
n=45; farx(n+1)=4.689202e+000; foe(n+1)=2.342542e+001; krok(n+1)=4.655230e-002; ng(n+1)=3.225024e+003;
n=46; farx(n+1)=4.615503e+000; foe(n+1)=2.202560e+001; krok(n+1)=2.424720e-003; ng(n+1)=1.667474e+003;
n=47; farx(n+1)=4.592987e+000; foe(n+1)=2.169864e+001; krok(n+1)=2.909519e-003; ng(n+1)=5.649926e+002;
n=48; farx(n+1)=4.907624e+000; foe(n+1)=2.090842e+001; krok(n+1)=1.879492e-002; ng(n+1)=5.209962e+002;
n=49; farx(n+1)=5.010821e+000; foe(n+1)=1.949381e+001; krok(n+1)=3.481722e-002; ng(n+1)=9.726014e+002;
n=50; farx(n+1)=4.877513e+000; foe(n+1)=1.896328e+001; krok(n+1)=2.366103e-002; ng(n+1)=2.765941e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.875610e+000; foe(n+1)=1.881385e+001; krok(n+1)=4.601933e-006; ng(n+1)=5.846488e+002;
n=52; farx(n+1)=4.923820e+000; foe(n+1)=1.863259e+001; krok(n+1)=4.554170e-005; ng(n+1)=2.392186e+002;
n=53; farx(n+1)=4.807688e+000; foe(n+1)=1.841746e+001; krok(n+1)=4.862099e-005; ng(n+1)=2.279613e+002;
n=54; farx(n+1)=4.520589e+000; foe(n+1)=1.750894e+001; krok(n+1)=2.779644e-004; ng(n+1)=2.407351e+002;
n=55; farx(n+1)=3.242354e+000; foe(n+1)=1.348989e+001; krok(n+1)=1.364485e-003; ng(n+1)=2.546490e+002;
n=56; farx(n+1)=2.806161e+000; foe(n+1)=1.183282e+001; krok(n+1)=1.548092e-003; ng(n+1)=1.048165e+003;
n=57; farx(n+1)=2.487856e+000; foe(n+1)=1.083269e+001; krok(n+1)=1.317301e-003; ng(n+1)=7.407037e+002;
n=58; farx(n+1)=2.395302e+000; foe(n+1)=1.034323e+001; krok(n+1)=1.066758e-003; ng(n+1)=1.400094e+003;
n=59; farx(n+1)=2.007650e+000; foe(n+1)=9.062815e+000; krok(n+1)=4.678366e-003; ng(n+1)=8.128628e+002;
n=60; farx(n+1)=1.810575e+000; foe(n+1)=8.347715e+000; krok(n+1)=5.485375e-003; ng(n+1)=1.103412e+003;
n=61; farx(n+1)=1.675389e+000; foe(n+1)=7.812946e+000; krok(n+1)=1.214360e-002; ng(n+1)=2.825142e+002;
n=62; farx(n+1)=1.580200e+000; foe(n+1)=7.453220e+000; krok(n+1)=1.713251e-003; ng(n+1)=9.173737e+002;
n=63; farx(n+1)=1.527321e+000; foe(n+1)=7.184738e+000; krok(n+1)=5.062842e-003; ng(n+1)=4.103006e+002;
n=64; farx(n+1)=1.425472e+000; foe(n+1)=6.876321e+000; krok(n+1)=7.993461e-003; ng(n+1)=5.650982e+002;
n=65; farx(n+1)=1.371083e+000; foe(n+1)=6.719179e+000; krok(n+1)=1.883428e-002; ng(n+1)=1.420639e+002;
n=66; farx(n+1)=1.430315e+000; foe(n+1)=6.433297e+000; krok(n+1)=9.909413e-002; ng(n+1)=9.085212e+001;
n=67; farx(n+1)=1.437781e+000; foe(n+1)=6.324183e+000; krok(n+1)=1.375044e-002; ng(n+1)=4.959217e+002;
n=68; farx(n+1)=1.455703e+000; foe(n+1)=6.112857e+000; krok(n+1)=2.055621e-002; ng(n+1)=2.178081e+002;
n=69; farx(n+1)=1.455119e+000; foe(n+1)=5.935580e+000; krok(n+1)=2.992730e-002; ng(n+1)=1.609630e+002;
n=70; farx(n+1)=1.329087e+000; foe(n+1)=5.575974e+000; krok(n+1)=8.139610e-002; ng(n+1)=4.060020e+002;
n=71; farx(n+1)=1.310618e+000; foe(n+1)=5.400651e+000; krok(n+1)=3.836134e-002; ng(n+1)=2.283656e+002;
n=72; farx(n+1)=1.285120e+000; foe(n+1)=5.204263e+000; krok(n+1)=4.505124e-002; ng(n+1)=1.720844e+002;
n=73; farx(n+1)=1.227042e+000; foe(n+1)=4.907068e+000; krok(n+1)=1.775417e-001; ng(n+1)=3.699403e+002;
n=74; farx(n+1)=1.180425e+000; foe(n+1)=4.719604e+000; krok(n+1)=2.949608e-001; ng(n+1)=1.788425e+002;
n=75; farx(n+1)=1.131549e+000; foe(n+1)=4.588592e+000; krok(n+1)=1.379942e-001; ng(n+1)=1.731810e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.132196e+000; foe(n+1)=4.585331e+000; krok(n+1)=2.649442e-006; ng(n+1)=1.276549e+002;
n=77; farx(n+1)=1.131436e+000; foe(n+1)=4.570807e+000; krok(n+1)=1.107642e-004; ng(n+1)=4.301807e+001;
n=78; farx(n+1)=1.129431e+000; foe(n+1)=4.559445e+000; krok(n+1)=3.575282e-005; ng(n+1)=6.371686e+001;
n=79; farx(n+1)=1.133647e+000; foe(n+1)=4.541289e+000; krok(n+1)=1.985317e-004; ng(n+1)=3.545701e+001;
n=80; farx(n+1)=1.099578e+000; foe(n+1)=4.471268e+000; krok(n+1)=7.988163e-004; ng(n+1)=3.679158e+001;
n=81; farx(n+1)=1.110690e+000; foe(n+1)=4.354424e+000; krok(n+1)=6.216787e-003; ng(n+1)=3.019253e+001;
n=82; farx(n+1)=1.108497e+000; foe(n+1)=4.263298e+000; krok(n+1)=4.606611e-003; ng(n+1)=4.400620e+001;
n=83; farx(n+1)=1.077419e+000; foe(n+1)=4.126583e+000; krok(n+1)=3.426502e-003; ng(n+1)=1.406445e+002;
n=84; farx(n+1)=1.050967e+000; foe(n+1)=4.007489e+000; krok(n+1)=2.580064e-002; ng(n+1)=4.819419e+002;
n=85; farx(n+1)=1.042520e+000; foe(n+1)=3.890558e+000; krok(n+1)=6.353015e-003; ng(n+1)=3.163636e+002;
n=86; farx(n+1)=9.424603e-001; foe(n+1)=3.627827e+000; krok(n+1)=3.982240e-002; ng(n+1)=3.741332e+002;
n=87; farx(n+1)=8.974012e-001; foe(n+1)=3.498741e+000; krok(n+1)=4.447430e-003; ng(n+1)=6.697592e+002;
n=88; farx(n+1)=8.912094e-001; foe(n+1)=3.434927e+000; krok(n+1)=3.572423e-003; ng(n+1)=5.422068e+002;
n=89; farx(n+1)=8.355466e-001; foe(n+1)=3.298903e+000; krok(n+1)=3.329590e-002; ng(n+1)=2.620067e+002;
n=90; farx(n+1)=8.181596e-001; foe(n+1)=3.244682e+000; krok(n+1)=2.580064e-002; ng(n+1)=3.710424e+002;
n=91; farx(n+1)=8.031523e-001; foe(n+1)=3.185537e+000; krok(n+1)=1.576669e-002; ng(n+1)=6.072403e+002;
n=92; farx(n+1)=7.904292e-001; foe(n+1)=3.097939e+000; krok(n+1)=4.277073e-002; ng(n+1)=4.033899e+002;
n=93; farx(n+1)=5.759483e-001; foe(n+1)=2.702312e+000; krok(n+1)=3.838379e-001; ng(n+1)=4.066325e+002;
n=94; farx(n+1)=5.334053e-001; foe(n+1)=2.413113e+000; krok(n+1)=5.411858e-002; ng(n+1)=2.323715e+002;
n=95; farx(n+1)=5.020799e-001; foe(n+1)=2.278300e+000; krok(n+1)=4.346837e-002; ng(n+1)=7.949765e+002;
n=96; farx(n+1)=4.866104e-001; foe(n+1)=2.131092e+000; krok(n+1)=5.034993e-002; ng(n+1)=3.746815e+002;
n=97; farx(n+1)=4.444597e-001; foe(n+1)=1.928588e+000; krok(n+1)=7.000904e-002; ng(n+1)=6.093695e+002;
n=98; farx(n+1)=3.645865e-001; foe(n+1)=1.712952e+000; krok(n+1)=1.312690e-001; ng(n+1)=6.543610e+002;
n=99; farx(n+1)=3.423336e-001; foe(n+1)=1.599360e+000; krok(n+1)=7.549232e-002; ng(n+1)=8.743120e+002;
n=100; farx(n+1)=3.258156e-001; foe(n+1)=1.440307e+000; krok(n+1)=1.652088e-001; ng(n+1)=4.304474e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
